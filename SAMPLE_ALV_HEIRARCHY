*&---------------------------------------------------------------------*
*& Report ZREPORT_SAMPLE_ALV_HIRE1
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
REPORT zreport_sample_alv_hire1.

TYPES : BEGIN OF lty_vbak,
          vbeln TYPE vbeln_va,
          erdat TYPE erdat,
          erzet TYPE erzet,
          ernam TYPE ernam,
          vbtyp TYPE vbtypl,
        END OF lty_vbak.

TYPES : BEGIN OF lty_vbap,
          vbeln TYPE vbeln_va,
          posnr TYPE posnr_va,
          matnr TYPE matnr,
        END OF lty_vbap.

DATA : lt_vbak TYPE TABLE OF lty_vbak.
DATA : lw_vbak TYPE lty_vbak.
DATA : lt_vbap TYPE TABLE OF lty_vbap.
DATA : lw_vbap TYPE lty_vbap.
DATA : v_ono TYPE vbeln_va.
DATA : lt_fieldcat TYPE slis_t_fieldcat_alv.
DATA : lw_fieldcat TYPE slis_fieldcat_alv.
DATA : ls_keyinfo TYPE SLIS_KEYINFO_ALV.

SELECT-OPTIONS : s_ono FOR v_ono.

SELECT vbeln erdat erzet ernam vbtyp
FROM vbak
INTO TABLE lt_vbak
WHERE vbeln IN s_ono.

IF lt_vbak IS NOT INITIAL.
  SELECT vbeln posnr matnr
  FROM vbap
  INTO TABLE lt_vbap
  FOR ALL ENTRIES IN lt_vbak
  WHERE vbeln = lt_vbak-vbeln.
ENDIF.

lw_fieldcat-col_pos = '1'.
lw_fieldcat-fieldname = 'VBELN'.
lw_fieldcat-tabname = 'LT_VBAK'.
lw_fieldcat-seltext_l = 'Sales Document Number'.
APPEND lw_fieldcat TO lt_fieldcat.
CLEAR lw_fieldcat.

lw_fieldcat-col_pos = '2'.
lw_fieldcat-fieldname = 'ERDAT'.
lw_fieldcat-tabname = 'LT_VBAK'.
lw_fieldcat-seltext_l = 'creation Date'.
APPEND lw_fieldcat TO lt_fieldcat.
CLEAR lw_fieldcat.

lw_fieldcat-col_pos = '3'.
lw_fieldcat-fieldname = 'ERZET'.
lw_fieldcat-tabname = 'LT_VBAK'.
lw_fieldcat-seltext_l = 'Time'.
APPEND lw_fieldcat TO lt_fieldcat.
CLEAR lw_fieldcat.

lw_fieldcat-col_pos = '4'.
lw_fieldcat-fieldname = 'ERNAM'.
lw_fieldcat-tabname = 'LT_VBAK'.
lw_fieldcat-seltext_l = 'User'.
APPEND lw_fieldcat TO lt_fieldcat.
CLEAR lw_fieldcat.

lw_fieldcat-col_pos = '5'.
lw_fieldcat-fieldname = 'VBTYP'.
lw_fieldcat-tabname = 'LT_VBAK'.
lw_fieldcat-seltext_l = 'Category'.
APPEND lw_fieldcat TO lt_fieldcat.
CLEAR lw_fieldcat.

lw_fieldcat-col_pos = '1'.
lw_fieldcat-fieldname = 'VBELN'.
lw_fieldcat-tabname = 'LT_VBAP'.
lw_fieldcat-seltext_l = 'Sales Document Number'.
APPEND lw_fieldcat TO lt_fieldcat.
CLEAR lw_fieldcat.

lw_fieldcat-col_pos = '2'.
lw_fieldcat-fieldname = 'POSNR'.
lw_fieldcat-tabname = 'LT_VBAP'.
lw_fieldcat-seltext_l = 'Item Number'.
APPEND lw_fieldcat TO lt_fieldcat.
CLEAR lw_fieldcat.

lw_fieldcat-col_pos = '3'.
lw_fieldcat-fieldname = 'MATNR'.
lw_fieldcat-tabname = 'LT_VBAP'.
lw_fieldcat-seltext_l = 'Material Number'.
APPEND lw_fieldcat TO lt_fieldcat.
CLEAR lw_fieldcat.

ls_keyinfo-header01 = 'VBELN'.
ls_keyinfo-item01 = 'VBELN'.

CALL FUNCTION 'REUSE_ALV_HIERSEQ_LIST_DISPLAY'
  EXPORTING
*   I_INTERFACE_CHECK              = ' '
*   I_CALLBACK_PROGRAM             =
*   I_CALLBACK_PF_STATUS_SET       = ' '
*   I_CALLBACK_USER_COMMAND        = ' '
*   IS_LAYOUT                      =
   IT_FIELDCAT                    = lt_fieldcat
*   IT_EXCLUDING                   =
*   IT_SPECIAL_GROUPS              =
*   IT_SORT                        =
*   IT_FILTER                      =
*   IS_SEL_HIDE                    =
*   I_SCREEN_START_COLUMN          = 0
*   I_SCREEN_START_LINE            = 0
*   I_SCREEN_END_COLUMN            = 0
*   I_SCREEN_END_LINE              = 0
*   I_DEFAULT                      = 'X'
*   I_SAVE                         = ' '
*   IS_VARIANT                     =
*   IT_EVENTS                      =
*   IT_EVENT_EXIT                  =
    i_tabname_header               = 'LT_VBAK'
    i_tabname_item                 = 'LT_VBAP'
*   I_STRUCTURE_NAME_HEADER        =
*   I_STRUCTURE_NAME_ITEM          =
    is_keyinfo                     = ls_keyinfo
*   IS_PRINT                       =
*   IS_REPREP_ID                   =
*   IS_HIERSEQ_SETTINGS            =
*   I_BYPASSING_BUFFER             =
*   I_BUFFER_ACTIVE                =
*   IR_SALV_HIERSEQ_ADAPTER        =
*   IT_EXCEPT_QINFO                =
*   I_SUPPRESS_EMPTY_DATA          = ABAP_FALSE
*   I_LIST_DISPLAY_ONLY            = ABAP_FALSE
*   O_COMMON_HUB                   =
* IMPORTING
*   E_EXIT_CAUSED_BY_CALLER        =
*   ES_EXIT_CAUSED_BY_USER         =
  TABLES
    t_outtab_header                = lt_vbak
    t_outtab_item                  = lt_vbap
 EXCEPTIONS
   PROGRAM_ERROR                  = 1
   OTHERS                         = 2
          .
IF sy-subrc <> 0.
* Implement suitable error handling here
ENDIF.
