*&---------------------------------------------------------------------*
*& Include          ZVBAP_CLASS
*&---------------------------------------------------------------------*
CLASS vbap_class DEFINITION INHERITING FROM ab_class.
  PUBLIC SECTION.
    METHODS ab_method REDEFINITION.
    METHODS vbak REDEFINITION.
    METHODS vbak_display REDEFINITION.
    METHODS : vbap,vbap_display.
ENDCLASS.

CLASS vbap_class IMPLEMENTATION.
  METHOD ab_method.
    me->ab_method( s_vbeln[] ).
  ENDMETHOD.

  METHOD vbak.
    SELECT vbeln erzet erdat ernam vbtyp
   FROM vbak
     INTO TABLE itab
   WHERE vbeln IN s_vbeln.
  ENDMETHOD.

  METHOD vbak_display.
    me->vbak( ).
    DATA wa_fieldcat TYPE lvc_s_fcat.
    DATA itab_fieldcat TYPE lvc_t_fcat.
    DATA lo_object TYPE REF TO cl_gui_custom_container.
    DATA lo_grid TYPE REF TO cl_gui_alv_grid.


    wa_fieldcat-col_pos = '1'.
    wa_fieldcat-fieldname = 'VBELN'.
    wa_fieldcat-scrtext_l = 'Sales Document Number'.
    wa_fieldcat-just = 'X'.
    APPEND wa_fieldcat TO itab_fieldcat.
    CLEAR wa_fieldcat.

    wa_fieldcat-col_pos = '2'.
    wa_fieldcat-fieldname = 'ERDAT'.
    wa_fieldcat-scrtext_l = 'Creation Date'.
    wa_fieldcat-just = 'X'.
    APPEND wa_fieldcat TO itab_fieldcat.
    CLEAR wa_fieldcat.

    wa_fieldcat-col_pos = '3'.
    wa_fieldcat-fieldname = 'ERZET'.
    wa_fieldcat-scrtext_l = 'Time'.
    wa_fieldcat-just = 'X'.
    APPEND wa_fieldcat TO itab_fieldcat.
    CLEAR wa_fieldcat.

    wa_fieldcat-col_pos = '4'.
    wa_fieldcat-fieldname = 'ERNAM'.
    wa_fieldcat-scrtext_l = 'Name'.
    wa_fieldcat-just = 'X'.
    APPEND wa_fieldcat TO itab_fieldcat.
    CLEAR wa_fieldcat.

    wa_fieldcat-col_pos = '5'.
    wa_fieldcat-fieldname = 'VBTYP'.
    wa_fieldcat-scrtext_l = 'Document Type'.
    wa_fieldcat-just = 'X'.
    APPEND wa_fieldcat TO itab_fieldcat.
    CLEAR wa_fieldcat.

    CREATE OBJECT lo_object
      EXPORTING
        container_name = 'CONT'.

    CREATE OBJECT lo_grid
      EXPORTING
        i_parent = lo_object.

    CALL METHOD lo_grid->set_table_for_first_display
      EXPORTING
        i_structure_name              = 'LS'
      CHANGING
        it_outtab                     = itab
        it_fieldcatalog               = itab_fieldcat
*       it_sort                       =
*       it_filter                     =
      EXCEPTIONS
        invalid_parameter_combination = 1
        program_error                 = 2
        too_many_lines                = 3
        OTHERS                        = 4.
    IF sy-subrc <> 0.
      MESSAGE 'Implement suitable error handling here' TYPE 'E'.
    ENDIF.
  ENDMETHOD.

  METHOD vbap.
    SELECT vbeln posnr matnr pmatn matkl pstyv
    FROM vbap
    INTO TABLE itab_vbap
    WHERE vbeln IN s_vbeln.
  ENDMETHOD.

  METHOD vbap_display.
    me->vbap( ).
    DATA wa_fieldcat TYPE lvc_s_fcat.
    DATA itab_fieldcat TYPE lvc_t_fcat.
    DATA lo_object TYPE REF TO cl_gui_custom_container.
    DATA lo_grid TYPE REF TO cl_gui_alv_grid.

    wa_fieldcat-col_pos = '1'.
    wa_fieldcat-fieldname = 'VBELN'.
    wa_fieldcat-scrtext_l = 'Sales Document Number'.
    wa_fieldcat-just = 'X'.
    APPEND wa_fieldcat TO itab_fieldcat.
    CLEAR wa_fieldcat.

    wa_fieldcat-col_pos = '2'.
    wa_fieldcat-fieldname = 'POSNR'.
    wa_fieldcat-scrtext_l = 'Sales Document Item'.
    wa_fieldcat-just = 'X'.
    APPEND wa_fieldcat TO itab_fieldcat.
    CLEAR wa_fieldcat.

    wa_fieldcat-col_pos = '3'.
    wa_fieldcat-fieldname = 'MATNR'.
    wa_fieldcat-scrtext_l = 'Material Number'.
    wa_fieldcat-just = 'X'.
    APPEND wa_fieldcat TO itab_fieldcat.
    CLEAR wa_fieldcat.

    wa_fieldcat-col_pos = '4'.
    wa_fieldcat-fieldname = 'PMATN'.
    wa_fieldcat-scrtext_l = 'Pricing Reference Material'.
    wa_fieldcat-just = 'X'.
    APPEND wa_fieldcat TO itab_fieldcat.
    CLEAR wa_fieldcat.

    wa_fieldcat-col_pos = '5'.
    wa_fieldcat-fieldname = 'MATKL'.
    wa_fieldcat-scrtext_l = 'Material Group'.
    wa_fieldcat-just = 'X'.
    APPEND wa_fieldcat TO itab_fieldcat.
    CLEAR wa_fieldcat.

    wa_fieldcat-col_pos = '6'.
    wa_fieldcat-fieldname = 'PSTYV'.
    wa_fieldcat-scrtext_l = 'Sales D Item Category'.
    wa_fieldcat-just = 'X'.
    APPEND wa_fieldcat TO itab_fieldcat.
    CLEAR wa_fieldcat.

    CREATE OBJECT lo_object
      EXPORTING
        container_name = 'COT'.

    CREATE OBJECT lo_grid
      EXPORTING
        i_parent = lo_object.

    CALL METHOD lo_grid->set_table_for_first_display
      EXPORTING
        i_structure_name              = 'LS'
      CHANGING
        it_outtab                     = itab_vbap
        it_fieldcatalog               = itab_fieldcat
*       it_sort                       =
*       it_filter                     =
      EXCEPTIONS
        invalid_parameter_combination = 1
        program_error                 = 2
        too_many_lines                = 3
        OTHERS                        = 4.
    IF sy-subrc <> 0.
      MESSAGE 'Implement suitable error handling here' TYPE 'E'.
    ENDIF.
  ENDMETHOD.

ENDCLASS.
