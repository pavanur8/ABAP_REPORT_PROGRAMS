*&---------------------------------------------------------------------*
*& Include          ZSOD_ANALYTICS_DEC
*&---------------------------------------------------------------------*
DATA: cc            TYPE REF TO cl_gui_custom_container,
      gd            TYPE REF TO cl_gui_alv_grid,
      g_grid        TYPE REF TO cl_gui_alv_grid,
      o_splitter    TYPE REF TO cl_gui_splitter_container,
      o_parent_grid TYPE REF TO cl_gui_container,
      o_parent_top  TYPE REF TO cl_gui_container,
      o_html_cntrl  TYPE REF TO cl_gui_html_viewer,
      o_dyndoc_id   TYPE REF TO cl_dd_document.

TABLES mara.
********************* types declaration **********
TYPES : BEGIN OF ty_ce1gnpl,
          matnr TYPE mara-matnr,
          werks TYPE marc-werks,
          vvvol TYPE ce1gnpl-absmg,
        END OF ty_ce1gnpl.

TYPES: BEGIN OF ty_final_bulk_st,
         mandt             TYPE mandt,
         matnr             TYPE mara-matnr,
         werks             TYPE marc-werks,
         factory           TYPE werks_d,
         maktx             TYPE makt-maktx,
         bulk              TYPE zupdate_table-idnrk,
         bulk_des          TYPE maktx,
         wrkst             TYPE wrkst,
         last_15m_sales    TYPE ce1gnpl-vvvol,
         last_3m_sales     TYPE ce1gnpl-vvvol,
         bulk_strategy(20) TYPE c,
         frequency         TYPE i,
         check(1)          TYPE c,
         status(15)        TYPE c,
         comment(25)       TYPE c,
         field_style       TYPE lvc_t_styl,
       END OF ty_final_bulk_st.

TYPES : BEGIN OF ty_ce1gnpl1,
          matnr TYPE mara-matnr,
          werks TYPE marc-werks,
          budat TYPE ce1gnpl-budat,
          vvvol TYPE ce1gnpl-absmg,
        END OF ty_ce1gnpl1.

TYPES : BEGIN OF ty_ce1gnpl2,
          matnr    TYPE mara-matnr,
          werks    TYPE marc-werks,
          month(3) TYPE c,
          vvvol    TYPE ce1gnpl-absmg,
          freq     TYPE i,
        END OF ty_ce1gnpl2.

TYPES: BEGIN OF ty_zscpc_db_fdp_new,
         matnr  TYPE mara-matnr,
         werks  TYPE marc-werks,
         cb_dis TYPE zscpc_db_fdp_new-cb_dis,
       END OF ty_zscpc_db_fdp_new.

TYPES: BEGIN OF ty_zscpc_db_fdp_new1,
         matnr      TYPE mara-matnr,
         werks      TYPE marc-werks,
         budat_mkpf TYPE zscpc_db_fdp_new-budat_mkpf,
         cb_dis     TYPE zscpc_db_fdp_new-cb_dis,
       END OF ty_zscpc_db_fdp_new1.

TYPES: BEGIN OF ty_zscpc_db_fdp_new2,
         matnr    TYPE mara-matnr,
         werks    TYPE marc-werks,
         month(3) TYPE c,
         cb_dis   TYPE zscpc_db_fdp_new-cb_dis,
       END OF ty_zscpc_db_fdp_new2.

TYPES: BEGIN OF ty_mseg,
         matnr TYPE mara-matnr,
         werks TYPE marc-werks,
         menge TYPE mseg-menge,
       END OF ty_mseg.

TYPES: BEGIN OF ty_mseg1,
         matnr      TYPE mara-matnr,
         werks      TYPE marc-werks,
         budat_mkpf TYPE budat,
         menge      TYPE mseg-menge,
       END OF ty_mseg1.

TYPES: BEGIN OF ty_mseg2,
         matnr    TYPE mara-matnr,
         werks    TYPE marc-werks,
         month(3) TYPE c,
         menge    TYPE mseg-menge,
       END OF ty_mseg2.

TYPES: BEGIN OF ty_final,
         matnr                    TYPE mara-matnr,
         maktx                    TYPE makt-maktx,
         matkl                    TYPE mara-matkl,
         wgbez                    TYPE t023t-wgbez,
         wrkst                    TYPE mara-wrkst,
         werks                    TYPE marc-werks,
         last_15m_sales           TYPE ce1gnpl-vvvol,
         m1                       TYPE ce1gnpl-vvvol,
         m2                       TYPE ce1gnpl-vvvol,
         m3                       TYPE ce1gnpl-vvvol,
         m4                       TYPE ce1gnpl-vvvol,
         m5                       TYPE ce1gnpl-vvvol,
         m6                       TYPE ce1gnpl-vvvol,
         m7                       TYPE ce1gnpl-vvvol,
         m8                       TYPE ce1gnpl-vvvol,
         m9                       TYPE ce1gnpl-vvvol,
         m10                      TYPE ce1gnpl-vvvol,
         m11                      TYPE ce1gnpl-vvvol,
         m12                      TYPE ce1gnpl-vvvol,
         m13                      TYPE ce1gnpl-vvvol,
         m14                      TYPE ce1gnpl-vvvol,
         m15                      TYPE ce1gnpl-vvvol,
         sales_frequency          TYPE i,
         avg_sales                TYPE ce1gnpl-vvvol,
         mat_group_flag(15)       TYPE c,
         sales_frequency_flag(10) TYPE c,
         bulk_strategy(20)        TYPE c,
         avg_sales_band(5)        TYPE c,
         factory                  TYPE werks_d,
         bulk                     TYPE zupdate_table-idnrk,
         bulk_des                 TYPE maktx,
         last_15m_prd             TYPE zscpc_db_fdp_new-cb_dis,
         prd_frequency            TYPE i,
         avg_prd                  TYPE zscpc_db_fdp_new-cb_dis,
         pr_m1                    TYPE zscpc_db_fdp_new-cb_dis,
         pr_m2                    TYPE zscpc_db_fdp_new-cb_dis,
         pr_m3                    TYPE zscpc_db_fdp_new-cb_dis,
         pr_m4                    TYPE zscpc_db_fdp_new-cb_dis,
         pr_m5                    TYPE zscpc_db_fdp_new-cb_dis,
         pr_m6                    TYPE zscpc_db_fdp_new-cb_dis,
         pr_m7                    TYPE zscpc_db_fdp_new-cb_dis,
         pr_m8                    TYPE zscpc_db_fdp_new-cb_dis,
         pr_m9                    TYPE zscpc_db_fdp_new-cb_dis,
         pr_m10                   TYPE zscpc_db_fdp_new-cb_dis,
         pr_m11                   TYPE zscpc_db_fdp_new-cb_dis,
         pr_m12                   TYPE zscpc_db_fdp_new-cb_dis,
         pr_m13                   TYPE zscpc_db_fdp_new-cb_dis,
         pr_m14                   TYPE zscpc_db_fdp_new-cb_dis,
         pr_m15                   TYPE zscpc_db_fdp_new-cb_dis,
         pr_m1_band(5)            TYPE c,
         pr_m2_band(5)            TYPE c,
         pr_m3_band(5)            TYPE c,
         pr_m4_band(5)            TYPE c,
         pr_m5_band(5)            TYPE c,
         pr_m6_band(5)            TYPE c,
         pr_m7_band(5)            TYPE c,
         pr_m8_band(5)            TYPE c,
         pr_m9_band(5)            TYPE c,
         pr_m10_band(5)           TYPE c,
         pr_m11_band(5)           TYPE c,
         pr_m12_band(5)           TYPE c,
         pr_m13_band(5)           TYPE c,
         pr_m14_band(5)           TYPE c,
         pr_m15_band(5)           TYPE c,
       END OF ty_final.

***** internal tables & work area declarations
DATA: it_ce1gnpl           TYPE STANDARD TABLE OF ty_ce1gnpl,
      it_ce1gnpl1          TYPE STANDARD TABLE OF ty_ce1gnpl1,
      it_ce1gnpl2          TYPE STANDARD TABLE OF ty_ce1gnpl2,
      wa_ce1gnpl           TYPE ty_ce1gnpl,
      wa_ce1gnpl1          TYPE ty_ce1gnpl1,
      wa_ce1gnpl2          TYPE ty_ce1gnpl2,
      it_final             TYPE STANDARD TABLE OF ty_final,
      it_final_prd         TYPE STANDARD TABLE OF ty_final,
      it_final_prd1        TYPE STANDARD TABLE OF ty_final,
      wa_final             TYPE ty_final,
      wa_final_prd         TYPE ty_final,
      wa_final_prd1        TYPE ty_final,
      it_zscpc_db_fdp_new  TYPE STANDARD TABLE OF ty_zscpc_db_fdp_new,
      it_zscpc_db_fdp_new1 TYPE STANDARD TABLE OF ty_zscpc_db_fdp_new1,
      it_zscpc_db_fdp_new2 TYPE STANDARD TABLE OF ty_zscpc_db_fdp_new2,
      wa_zscpc_db_fdp_new  TYPE ty_zscpc_db_fdp_new,
      wa_zscpc_db_fdp_new1 TYPE ty_zscpc_db_fdp_new1,
      wa_zscpc_db_fdp_new2 TYPE ty_zscpc_db_fdp_new2.

DATA: wa_final_bulk_st  TYPE ty_final_bulk_st,
      it_final_bulk_st  TYPE STANDARD TABLE OF ty_final_bulk_st,
      wa_final_bulk_st1 TYPE zsod_analytics.

DATA ls_stylerow TYPE lvc_s_styl .                              "WORKAREA
DATA lt_styletab TYPE TABLE OF lvc_s_styl . "LVC_T_STYL .       "INTERNAL TABLE

DATA: it_fcat     TYPE lvc_t_fcat,
      it_fcat_prd TYPE lvc_t_fcat,
      wa_fcat     TYPE lvc_s_fcat,
      wa_fcat_prd TYPE lvc_s_fcat.

DATA: it_mseg  TYPE STANDARD TABLE OF ty_mseg,
      it_mseg1 TYPE STANDARD TABLE OF ty_mseg1,
      it_mseg2 TYPE STANDARD TABLE OF ty_mseg2,
      wa_mseg  TYPE ty_mseg,
      wa_mseg1 TYPE ty_mseg1,
      wa_mseg2 TYPE ty_mseg2.

***** variables declaration

DATA: month1        TYPE sy-datum,
      month2        TYPE sy-datum,
      month3        TYPE sy-datum,
      month4        TYPE sy-datum,
      month5        TYPE sy-datum,
      month6        TYPE sy-datum,
      month7        TYPE sy-datum,
      month8        TYPE sy-datum,
      month9        TYPE sy-datum,
      month10       TYPE sy-datum,
      month11       TYPE sy-datum,
      month12       TYPE sy-datum,
      month13       TYPE sy-datum,
      month14       TYPE sy-datum,
      month15       TYPE sy-datum,
      count_m1      TYPE i,
      count_m2      TYPE i,
      count_m3      TYPE i,
      count_m4      TYPE i,
      count_m5      TYPE i,
      count_m6      TYPE i,
      count_m7      TYPE i,
      count_m8      TYPE i,
      count_m9      TYPE i,
      count_m10     TYPE i,
      count_m11     TYPE i,
      count_m12     TYPE i,
      count_m13     TYPE i,
      count_m14     TYPE i,
      count_m15     TYPE i,
      sno           TYPE i,
      sno_prd       TYPE i,
      sales_m15(20) TYPE c,
      sales_m14(20) TYPE c,
      sales_m13(20) TYPE c,
      sales_m12(20) TYPE c,
      sales_m11(20) TYPE c,
      sales_m10(20) TYPE c,
      sales_m9(20)  TYPE c,
      sales_m8(20)  TYPE c,
      sales_m7(20)  TYPE c,
      sales_m6(20)  TYPE c,
      sales_m5(20)  TYPE c,
      sales_m4(20)  TYPE c,
      sales_m3(20)  TYPE c,
      sales_m2(20)  TYPE c,
      sales_m1(20)  TYPE c,
      count_pr_m1   TYPE i,
      count_pr_m2   TYPE i,
      count_pr_m3   TYPE i,
      count_pr_m4   TYPE i,
      count_pr_m5   TYPE i,
      count_pr_m6   TYPE i,
      count_pr_m7   TYPE i,
      count_pr_m8   TYPE i,
      count_pr_m9   TYPE i,
      count_pr_m10  TYPE i,
      count_pr_m11  TYPE i,
      count_pr_m12  TYPE i,
      count_pr_m13  TYPE i,
      count_pr_m14  TYPE i,
      count_pr_m15  TYPE i,
      prd(15)       TYPE c,
      factory       TYPE werks_d.

DATA: v_first_day   TYPE sy-datum,
      v_last_day    TYPE sy-datum,
      lv_month(2)   TYPE c,
      lv_month2(2)  TYPE c,
      lv_month3(2)  TYPE c,
      lv_month4(2)  TYPE c,
      lv_month5(2)  TYPE c,
      lv_month6(2)  TYPE c,
      lv_month7(2)  TYPE c,
      lv_month8(2)  TYPE c,
      lv_month9(2)  TYPE c,
      lv_month10(2) TYPE c,
      lv_month11(2) TYPE c,
      lv_month12(2) TYPE c,
      lv_month13(2) TYPE c,
      lv_month14(2) TYPE c,
      lv_month15(2) TYPE c,
      lv_year(4)    TYPE c,
      lv_last_month TYPE sy-datum.
